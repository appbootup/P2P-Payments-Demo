<!--
   Permission is granted to copy, distribute and/or modify this document
   under the terms of the GNU Free Documentation License, Version 1.3
   or any later version published by the Free Software Foundation;
   with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
   A copy of the license is included in the folder entitled "GNU
   Free Documentation License".
   Scenario 2: Single late payment with mining.
   -->
<html>
   <head></head>
   <body>
      <script type="text/javascript" src="web3.min.js"></script>
      <script type='text/javascript'>
        var Web3 = require('web3');
        if (typeof web3 !== 'undefined') {
          web3 = new Web3(web3.currentProvider);
        } else {
          web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
        }
        web3.eth.defaultAccount = web3.eth.accounts[0];
        // New token contract:
        var betaContract = web3.eth.contract([{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_amount","type":"uint256"}],"name":"approve","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"}],"name":"burnTokenAmount","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_amount","type":"uint256"}],"name":"transferFrom","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"tokenManagerContractToSet","type":"address"}],"name":"setTokenManagerContractAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"turnHoldingRequirementOn","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"turnHoldingRequirementOff","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"devAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"},{"name":"addressToRemoveFrom","type":"address"}],"name":"removeAmountFromAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"devVestedAddress","type":"address"},{"name":"amount","type":"uint256"}],"name":"importDevBalanceThroughConverter","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"burnedAmount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"newHoldingChecker","type":"address"}],"name":"changeHoldingCheckerToAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"initialTokenManagerSet","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"}],"name":"addTestBalance","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"needsHoldingCheck","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"permissableAddress","type":"address"}],"name":"setPermissableAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"},{"name":"loser","type":"address"},{"name":"recip","type":"address"}],"name":"moveAmountFromAddressToAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"mineableAmount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"recip","type":"address"},{"name":"amount","type":"uint256"}],"name":"importBalanceThroughConverter","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"holdingManagerContract","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_amount","type":"uint256"}],"name":"transfer","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addressToDePermission","type":"address"}],"name":"killPermitImportBalanceForAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"converter","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"},{"name":"addressToAddTo","type":"address"}],"name":"addBalanceToAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"convertedAmount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"permittedBalanceImportMap","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"}],"name":"increaseMineableAmount","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_owner","type":"address"},{"indexed":true,"name":"_spender","type":"address"},{"indexed":false,"name":"_value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"address"},{"indexed":true,"name":"to","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"newAddress","type":"address"},{"indexed":false,"name":"authorizer","type":"address"}],"name":"AuthorizedPrivsForAddressUsingAuthorizer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"newAddress","type":"address"},{"indexed":false,"name":"authorizer","type":"address"}],"name":"KilledPrivsForAddressUsingAuthorizer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"newAddress","type":"address"},{"indexed":false,"name":"authorizer","type":"address"}],"name":"ChangedHoldingCheckerToAddressUsingAuthorizer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"authorizer","type":"address"}],"name":"TurnedHoldingRequirementOnUsingAuthorizer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"authorizer","type":"address"}],"name":"TurnedHoldingRequirementOffUsingAuthorizer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"amount","type":"uint256"},{"indexed":false,"name":"recipient","type":"address"},{"indexed":false,"name":"authorizer","type":"address"}],"name":"AddedAmountToAddressUsingAuthorizer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"amount","type":"uint256"},{"indexed":false,"name":"addressRemovedFrom","type":"address"},{"indexed":false,"name":"authorizer","type":"address"}],"name":"RemovedAmountFromAddressUsingAuthorizer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"amount","type":"uint256"},{"indexed":false,"name":"loser","type":"address"},{"indexed":false,"name":"recip","type":"address"}],"name":"MovedAmountFromAddressToAddress","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"amount","type":"uint256"},{"indexed":false,"name":"sender","type":"address"}],"name":"BurnedAmountForAddress","type":"event"}]);
        var beta = betaContract.new({
            from: web3.eth.accounts[0], 
            data: '0x606060405234156200001057600080fd5b60408051908101604052600481527f626574610000000000000000000000000000000000000000000000000000000060208201526000908051620000599291602001906200014f565b5060408051908101604052600481527f424554410000000000000000000000000000000000000000000000000000000060208201526001908051620000a39291602001906200014f565b506002805460ff19166012179055600480547440e8f3ff9118b6ecdd4c89051cf3515c543bb36a0061010060a860020a0319909116178082556101009004600160a060020a031660009081526009602052604090208054683635c9adc5dea0000090810190915560038054909101905560058054600160a060020a0319169055805460a860020a60ff0219167501000000000000000000000000000000000000000000179055620001f4565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200019257805160ff1916838001178555620001c2565b82800160010185558215620001c2579182015b82811115620001c2578251825591602001919060010190620001a5565b50620001d0929150620001d4565b5090565b620001f191905b80821115620001d05760008155600101620001db565b90565b6111ea80620002046000396000f3006060604052600436106101715763ffffffff60e060020a60003504166306fdde038114610176578063095ea7b314610200578063149c62731461023657806318160ddd1461024e57806323b872dd1461027357806330efd8551461029b578063313ce567146102ba57806332b63be4146102e3578063396975d5146102f65780633ad10ef61461030957806345bff339146103385780634fb24bc71461035a57806350e15fdd1461037c5780635fe255601461038f5780636d91c5f7146103ae57806370a08231146103c15780637b5c6bf7146103e05780637d59d8a7146103f65780638149a44414610409578063897b9dcc14610428578063920da53c1461045057806395bb38161461046357806395d89b4114610485578063968f017914610498578063a9059cbb146104ab578063b7d68c2c146104cd578063bd38837b146104ec578063bdc96fad146104ff578063ca5d337a14610521578063db0ca10514610534578063fec7461414610553575b600080fd5b341561018157600080fd5b610189610569565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101c55780820151838201526020016101ad565b50505050905090810190601f1680156101f25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561020b57600080fd5b610222600160a060020a0360043516602435610607565b604051901515815260200160405180910390f35b341561024157600080fd5b61024c600435610674565b005b341561025957600080fd5b6102616107b1565b60405190815260200160405180910390f35b341561027e57600080fd5b610222600160a060020a03600435811690602435166044356107b7565b34156102a657600080fd5b61024c600160a060020a0360043516610930565b34156102c557600080fd5b6102cd610995565b60405160ff909116815260200160405180910390f35b34156102ee57600080fd5b61024c61099e565b341561030157600080fd5b61024c610a24565b341561031457600080fd5b61031c610aa3565b604051600160a060020a03909116815260200160405180910390f35b341561034357600080fd5b61024c600435600160a060020a0360243516610ab7565b341561036557600080fd5b61024c600160a060020a0360043516602435610b86565b341561038757600080fd5b610261610bc7565b341561039a57600080fd5b61024c600160a060020a0360043516610bcd565b34156103b957600080fd5b610222610c5f565b34156103cc57600080fd5b610261600160a060020a0360043516610c68565b34156103eb57600080fd5b61024c600435610c83565b341561040157600080fd5b610222610cac565b341561041457600080fd5b61024c600160a060020a0360043516610cbc565b341561043357600080fd5b61024c600435600160a060020a0360243581169060443516610d4c565b341561045b57600080fd5b610261610e19565b341561046e57600080fd5b61024c600160a060020a0360043516602435610e1f565b341561049057600080fd5b610189610e70565b34156104a357600080fd5b61031c610edb565b34156104b657600080fd5b610222600160a060020a0360043516602435610eea565b34156104d857600080fd5b61024c600160a060020a036004351661104a565b34156104f757600080fd5b61031c6110d7565b341561050a57600080fd5b61024c600435600160a060020a03602435166110e6565b341561052c57600080fd5b610261611198565b341561053f57600080fd5b610222600160a060020a036004351661119e565b341561055e57600080fd5b61024c6004356111b3565b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105ff5780601f106105d4576101008083540402835291602001916105ff565b820191906000526020600020905b8154815290600101906020018083116105e257829003601f168201915b505050505081565b600160a060020a033381166000818152600c6020908152604080832094871680845294909152808220859055909291907f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9259085905190815260200160405180910390a35060015b92915050565b60045460a860020a900460ff161561070c57600b54600160a060020a0316637b56b3b8823360006040516020015260405160e060020a63ffffffff85160281526004810192909252600160a060020a03166024820152604401602060405180830381600087803b15156106e657600080fd5b6102c65a03f115156106f757600080fd5b50505060405180511515905061070c57600080fd5b600160a060020a03331660009081526009602052604090205481111561073157600080fd5b33600160a060020a0381166000908152600960205260409081902080548490039055600380548490039055600880548401905560078054840190557f37d1a8215fdbdd8e0d7d8e2738a59b9b06168981cec75212ed1f102eb8d00a5991839151918252600160a060020a031660208201526040908101905180910390a150565b60035481565b600160a060020a0383166000908152600960205260408120548290108015906108075750600160a060020a038085166000908152600c602090815260408083203390941683529290522054829010155b80156108135750600082115b80156108385750600160a060020a038316600090815260096020526040902054828101115b156109255760045460a860020a900460ff16156108d557600b54600160a060020a0316637b56b3b8838660006040516020015260405160e060020a63ffffffff85160281526004810192909252600160a060020a03166024820152604401602060405180830381600087803b15156108af57600080fd5b6102c65a03f115156108c057600080fd5b5050506040518051151590506108d557600080fd5b50600160a060020a03808416600090815260096020818152604080842080548790039055600c82528084203386168552825280842080548790039055938616835252208054820190556001610929565b5060005b9392505050565b60045460ff16151561099257600b805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0383169081179091556000908152600a60205260409020805460ff1990811660019081179092556004805490911690911790555b50565b60025460ff1681565b600160a060020a0333166000908152600a602052604090205460ff1615610a22576004805475ff000000000000000000000000000000000000000000191660a860020a1790557fd9163bb9a6cedcebaceb6e7de29266bb885b8857248a7b62c60b160d3bcbd61333604051600160a060020a03909116815260200160405180910390a15b565b600160a060020a0333166000908152600a602052604090205460ff1615610a22576004805475ff000000000000000000000000000000000000000000191690557f8812c490377130528286516043a8124d8365671b53843f9a15fa2e70c23a8a8c33604051600160a060020a03909116815260200160405180910390a1565b6004546101009004600160a060020a031681565b600160a060020a0333166000908152600a602052604090205460ff1615610b8257600160a060020a038116600090815260096020526040902054821115610afd57600080fd5b600160a060020a038116600090815260096020526040908190208054849003905560038054849003905560078054840190557fe126c0496b2f19bbdeecdff8e8871b077d918e0350c3cc233909c8e96b09fe609083908390339051928352600160a060020a039182166020840152166040808301919091526060909101905180910390a15b5050565b60055433600160a060020a0390811691161415610b8257600160a060020a038216600090815260096020526040902080548201905560038054820190555050565b60085481565b600160a060020a0333166000908152600a602052604090205460ff161561099257600b805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0383161790557f1fa4e7cc268eae9019fd403635f6cf7f75c2cbc04d259f0b09b651d066705c078133604051600160a060020a039283168152911660208201526040908101905180910390a150565b60045460ff1681565b600160a060020a031660009081526009602052604090205490565b600160a060020a0333166000908152600960205260409020805482019055600380549091019055565b60045460a860020a900460ff1681565b600160a060020a0333166000908152600a602052604090205460ff161561099257600160a060020a0381166000908152600a602052604090819020805460ff191660011790557f2a3622237aee797b2946fdca1d03f9f6b7a111f36c988584a69aea2ea464f30e908290339051600160a060020a039283168152911660208201526040908101905180910390a150565b600160a060020a0333166000908152600a602052604090205460ff1615610e1457600160a060020a038216600090815260096020526040902054831115610d9257600080fd5b600160a060020a038083166000908152600960205260408082208054879003905591831681528190208054850190557f65de1d45ea2855581c4776cff7089c7dba98d69ab0b7e77970a8b139f2e5140b9084908490849051928352600160a060020a039182166020840152166040808301919091526060909101905180910390a15b505050565b60075481565b60055433600160a060020a0390811691161415610b8257600160a060020a03821660009081526009602052604090208054820190556003805482019055600680548201905560078054820190555050565b60018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105ff5780601f106105d4576101008083540402835291602001916105ff565b600b54600160a060020a031681565b600160a060020a033316600090815260096020526040812054829010801590610f135750600082115b8015610f385750600160a060020a038316600090815260096020526040902054828101115b156110425760045460a860020a900460ff1615610fd557600b54600160a060020a0316637b56b3b8833360006040516020015260405160e060020a63ffffffff85160281526004810192909252600160a060020a03166024820152604401602060405180830381600087803b1515610faf57600080fd5b6102c65a03f11515610fc057600080fd5b505050604051805115159050610fd557600080fd5b600160a060020a033381166000818152600960205260408082208054879003905592861680825290839020805486019055917fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9085905190815260200160405180910390a350600161066e565b50600061066e565b600160a060020a0333166000908152600a602052604090205460ff161561099257600160a060020a0381166000908152600a602052604090819020805460ff191690557f010970f3bd39b910480f9efeaae7d0a0d77310e4e5e65d3bab5ddb4e83b322bf908290339051600160a060020a039283168152911660208201526040908101905180910390a150565b600554600160a060020a031681565b600160a060020a0333166000908152600a602052604090205460ff1615610b8257600754829010610b8257600780548390039055600160a060020a0381166000908152600960205260409081902080548401905560038054840190557ff2e308436940a25ca21154cd177dbe22147fe6f1c21d703f1a19dbef4e33b95f9083908390339051928352600160a060020a039182166020840152166040808301919091526060909101905180910390a15050565b60065481565b600a6020526000908152604090205460ff1681565b6007805490910190555600a165627a7a7230582099ebfb949f52a23102854b42aee27f3d9338b21c2604b74c88466d63533c367a0029', 
            gas: '4700000'
        }, function (e, mainContract) {
            if (typeof mainContract.address !== 'undefined') {
                console.log('New token contract mined, address: ' + mainContract.address + ' tx: ' + mainContract.transactionHash);
                // Token manager contract:
                var tokenmanager1Contract = web3.eth.contract([{"constant":true,"inputs":[],"name":"rewardFactorBorrower","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"newTokenAddressSet","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"REQUESTED_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"HOLD_DENOM","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"lP2","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalInHolding","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"newTokenAddy","type":"address"}],"name":"setNewTokenAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"rewardFactorLender","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"REQUEST_CANCELED_BY_BORROWER_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"newTokenAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"turnHoldingCheckerOn","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addressToDePermission","type":"address"}],"name":"dePermissionAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"newRewardFactorBorrower","type":"uint256"},{"name":"newRewardFactorLender","type":"uint256"}],"name":"changeRewardFactor","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addressToPermission","type":"address"}],"name":"permissionAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"newHoldingChecker","type":"address"}],"name":"changeHoldingCheckerToAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"turnHoldingCheckerOff","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"lP1","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"index","type":"uint256"}],"name":"cancelLoanRequestAtIndexByLender","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"lender","type":"address"},{"name":"amount","type":"uint256"},{"name":"length","type":"uint256"},{"name":"interest","type":"uint256"},{"name":"willMine","type":"bool"},{"name":"loanMessage","type":"string"}],"name":"requestLoan","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"},{"name":"addressToCheck","type":"address"}],"name":"holdingCheckForAddress","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"HOLD_NUM","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"num","type":"uint256"},{"name":"denom","type":"uint256"}],"name":"setHoldNumAndDenom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"BORROWER_PAID_LATE_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"COMPLETION_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"index","type":"uint256"}],"name":"cancelLoanRequestAtIndexByBorrower","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"ACTIVE_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"REQUEST_CANCELED_BY_LENDER_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"},{"name":"index","type":"uint256"}],"name":"payAmountForLoanAtIndex","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"holdingAmounts","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"permissionsContract","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"index","type":"uint256"}],"name":"requestRewardForLoanAtIndex","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"ACTIVE_LOAN_CANCELED_BY_LENDER_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"index","type":"uint256"}],"name":"attemptBeginLoanAtIndex","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"HOLDING_STATUS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"loans","outputs":[{"name":"borrower","type":"address"},{"name":"lender","type":"address"},{"name":"startBlock","type":"uint256"},{"name":"amount","type":"uint256"},{"name":"paidBackBlock","type":"uint256"},{"name":"status","type":"uint256"},{"name":"amountPaidBackSoFar","type":"uint256"},{"name":"loanLength","type":"uint256"},{"name":"borrowerReward","type":"uint256"},{"name":"lenderReward","type":"uint256"},{"name":"interest","type":"uint256"},{"name":"willMine","type":"bool"},{"name":"borrowerPaidLate","type":"bool"},{"name":"message","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"totalRewardsEarned","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"index","type":"uint256"}],"name":"cancelActiveLoanAtIndex","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"advanceBlock","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"}],"name":"LoanRequestedAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"}],"name":"LoanCanceledByBorrowerAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"}],"name":"LoanCanceledByLenderAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"}],"name":"LoanBegunAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"PaidBackPortionForLoanAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"LoanWentIntoHoldingAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"LoanPaidLateAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"},{"indexed":false,"name":"claimer","type":"address"}],"name":"RewardForLoanIndexClaimedByAddress","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"","type":"address"}],"name":"AddressAttemptedToBreakHolding","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"rewardFactorBorrower","type":"uint256"},{"indexed":false,"name":"rewardFactorLender","type":"uint256"},{"indexed":false,"name":"authorizer","type":"address"}],"name":"ChangedRewardFactorUsingLP","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"newConverter","type":"address"},{"indexed":false,"name":"LP","type":"address"}],"name":"ChangedConverterUsingLP","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"num","type":"uint256"},{"indexed":false,"name":"denom","type":"uint256"},{"indexed":false,"name":"lP","type":"address"}],"name":"ChangedHoldingPeriodLengthUsingParams","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"}],"name":"LoanRequestCanceledByLenderAtIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"index","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"NonMiningLoanCompletedAtIndex","type":"event"}]);
                var tokenmanager1 = tokenmanager1Contract.new({
                    from: web3.eth.accounts[0], 
                    data: '0x6060604052341561000f57600080fd5b600160008190555060026001819055506003600281905550600460038190555060056004819055506006808190555060078081905550600860058190555063037da8c9600c819055506301e13380600d8190555073bb505bd0667b0e3a594dc0b426a26dc4ad5e6375600a60006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507330667104ea64ad9b8217b0baf3023eb19533c92d600860006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555073ddd83d30b1248fc5d697cade816867f9a6399e07600960006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001601281905550600160138190555061318e806101816000396000f3006060604052600436106101d8576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063041fc298146101dd578063064ffa5a1461020657806314a6a1a514610233578063161314731461025c578063235c06421461028557806325e921e0146102da5780632cf033a0146103035780632df620761461033c57806335b1114a1461036557806337689c8d1461038e5780633a59a618146103e3578063415b8ba5146103f857806351aa451114610431578063586f681e1461045d5780635fe2556014610496578063649275ac146104cf578063651a14d9146104e45780636e6d83d21461053957806377d02fda1461055c5780637b56b3b8146106125780637cf96eee1461066c5780638563981514610695578063956dda7f146106c15780639f7ff381146106ea578063b686c98314610713578063ba70d54a14610736578063c32e16e71461075f578063c98c6e0814610788578063ca3100fd146107b4578063cccb7c7514610801578063d5722c4b14610856578063d598cae514610891578063d65995ed146108ba578063da039805146108f5578063e1ec3c681461091e578063e4f24cb014610a92578063e6f8298c14610adf578063e9f5b3c414610b02575b600080fd5b34156101e857600080fd5b6101f0610b17565b6040518082815260200191505060405180910390f35b341561021157600080fd5b610219610b1d565b604051808215151515815260200191505060405180910390f35b341561023e57600080fd5b610246610b30565b6040518082815260200191505060405180910390f35b341561026757600080fd5b61026f610b36565b6040518082815260200191505060405180910390f35b341561029057600080fd5b610298610b3c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156102e557600080fd5b6102ed610b62565b6040518082815260200191505060405180910390f35b341561030e57600080fd5b61033a600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610b68565b005b341561034757600080fd5b61034f610bde565b6040518082815260200191505060405180910390f35b341561037057600080fd5b610378610be4565b6040518082815260200191505060405180910390f35b341561039957600080fd5b6103a1610bea565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103ee57600080fd5b6103f6610c10565b005b341561040357600080fd5b61042f600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610cb9565b005b341561043c57600080fd5b61045b6004808035906020019091908035906020019091905050610d9a565b005b341561046857600080fd5b610494600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610e31565b005b34156104a157600080fd5b6104cd600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610f12565b005b34156104da57600080fd5b6104e2610ff3565b005b34156104ef57600080fd5b6104f761109c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561054457600080fd5b61055a60048080359060200190919050506110c2565b005b341561056757600080fd5b6105fc600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091908035906020019091908035906020019091908035151590602001909190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506111c5565b6040518082815260200191505060405180910390f35b341561061d57600080fd5b610652600480803590602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506114c2565b604051808215151515815260200191505060405180910390f35b341561067757600080fd5b61067f611668565b6040518082815260200191505060405180910390f35b34156106a057600080fd5b6106bf600480803590602001909190803590602001909190505061166e565b005b34156106cc57600080fd5b6106d4611701565b6040518082815260200191505060405180910390f35b34156106f557600080fd5b6106fd611707565b6040518082815260200191505060405180910390f35b341561071e57600080fd5b610734600480803590602001909190505061170d565b005b341561074157600080fd5b610749611810565b6040518082815260200191505060405180910390f35b341561076a57600080fd5b610772611816565b6040518082815260200191505060405180910390f35b341561079357600080fd5b6107b2600480803590602001909190803590602001909190505061181c565b005b34156107bf57600080fd5b6107eb600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611e76565b6040518082815260200191505060405180910390f35b341561080c57600080fd5b610814611e8e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561086157600080fd5b6108776004808035906020019091905050611eb4565b604051808215151515815260200191505060405180910390f35b341561089c57600080fd5b6108a46121dc565b6040518082815260200191505060405180910390f35b34156108c557600080fd5b6108db60048080359060200190919050506121e2565b604051808215151515815260200191505060405180910390f35b341561090057600080fd5b6109086124bf565b6040518082815260200191505060405180910390f35b341561092957600080fd5b61093f60048080359060200190919050506124c5565b604051808f73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018e73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018d81526020018c81526020018b81526020018a8152602001898152602001888152602001878152602001868152602001858152602001841515151581526020018315151515815260200180602001828103825283818154600181600116156101000203166002900481526020019150805460018160011615610100020316600290048015610a765780601f10610a4b57610100808354040283529160200191610a76565b820191906000526020600020905b815481529060010190602001808311610a5957829003601f168201915b50509f5050505050505050505050505050505060405180910390f35b3415610a9d57600080fd5b610ac9600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050612599565b6040518082815260200191505060405180910390f35b3415610aea57600080fd5b610b0060048080359060200190919050506125b1565b005b3415610b0d57600080fd5b610b156126b4565b005b600c5481565b600a60149054906101000a900460ff1681565b60005481565b60135481565b600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600e5481565b600a60149054906101000a900460ff161515610bdb576001600a60146101000a81548160ff02191690831515021790555080600b60006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50565b600d5481565b60035481565b600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b610c186126b6565b15610cb757600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166332b63be46040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401600060405180830381600087803b1515610ca257600080fd5b6102c65a03f11515610cb357600080fd5b5050505b565b610cc16126b6565b15610d9757600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b7d68c2c826040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050600060405180830381600087803b1515610d8257600080fd5b6102c65a03f11515610d9357600080fd5b5050505b50565b610da26126b6565b15610e2d5781600c8190555080600d819055507f93bd866b08323e00f707c2299a6467863b8ec228016a2a4f9f0637c160b500a0600c54600d5433604051808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a15b5050565b610e396126b6565b15610f0f57600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638149a444826040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050600060405180830381600087803b1515610efa57600080fd5b6102c65a03f11515610f0b57600080fd5b5050505b50565b610f1a6126b6565b15610ff057600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635fe25560826040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050600060405180830381600087803b1515610fdb57600080fd5b6102c65a03f11515610fec57600080fd5b5050505b50565b610ffb6126b6565b1561109a57600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663396975d56040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401600060405180830381600087803b151561108557600080fd5b6102c65a03f1151561109657600080fd5b5050505b565b600860009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600054600f828154811015156110d457fe5b90600052602060002090600d02016005015414801561115e57503373ffffffffffffffffffffffffffffffffffffffff16600f8281548110151561111457fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b156111c257600454600f8281548110151561117557fe5b90600052602060002090600d0201600501819055507facd4a5d7edf598621056e29f584a24187489661c79475da8e8a885e3d9741260816040518082815260200191505060405180910390a15b50565b60006111cf612e9c565b8773ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141561120857600080fd5b60008714806112175750600486105b806112255750630d6d26b786115b1561122f57600080fd5b6a52b7d2dcc80cd2e400000087118061125257506a52b7d2dcc80cd2e400000085115b1561125c57600080fd5b6101c0604051908101604052803373ffffffffffffffffffffffffffffffffffffffff1681526020018973ffffffffffffffffffffffffffffffffffffffff168152602001600081526020018881526020016000815260200160005481526020016000815260200187815260200160008152602001600081526020018681526020018515158152602001600015158152602001848152509050600f80548060010182816113099190612f42565b91600052602060002090600d0201600083909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160020155606082015181600301556080820151816004015560a0820151816005015560c0820151816006015560e082015181600701556101008201518160080155610120820151816009015561014082015181600a015561016082015181600b0160006101000a81548160ff02191690831515021790555061018082015181600b0160016101000a81548160ff0219169083151502179055506101a082015181600c019080519060200190611469929190612f74565b505050507f329ae0d6a028c98491fa343fea612add4805202131d3c03c8850c2d03a43ca846001600f80549050036040518082815260200191505060405180910390a16001600f80549050039150509695505050505050565b600080601160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231856000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b15156115ca57600080fd5b6102c65a03f115156115db57600080fd5b505050604051805190500390508084111561165c577f9e2ada2f5724bf6b960141fb059ede7602cebf9a328670dc4cf499fb75cb075783604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a160009150611661565b600191505b5092915050565b60125481565b6116766126b6565b156116fd5781601281905550806013819055507f75ddf2663e98a0871935dec0b5ccc9f3e798c51ee40999f21d1d0ac31560e901828233604051808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a15b5050565b60065481565b60075481565b600054600f8281548110151561171f57fe5b90600052602060002090600d0201600501541480156117a957503373ffffffffffffffffffffffffffffffffffffffff16600f8281548110151561175f57fe5b90600052602060002090600d020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b1561180d57600354600f828154811015156117c057fe5b90600052602060002090600d0201600501819055507f7f931ace8a19aa070de3541d954a82d6147d00de7d9c38bee30868f8e99be56b816040518082815260200191505060405180910390a15b50565b60015481565b60045481565b600154600f8281548110151561182e57fe5b90600052602060002090600d0201600501541480156118b85750600f8181548110151561185757fe5b90600052602060002090600d020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b80156118c45750600082115b15611e7257600f818154811015156118d857fe5b90600052602060002090600d0201600201544314156118f657600080fd5b61190082336114c2565b151561190b57600080fd5b600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663897b9dcc8333600f8581548110151561195a57fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518463ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019350505050600060405180830381600087803b1515611a4357600080fd5b6102c65a03f11515611a5457600080fd5b50505081600f82815481101515611a6757fe5b90600052602060002090600d020160060160008282540192505081905550600f81815481101515611a9457fe5b90600052602060002090600d0201600a0154600f82815481101515611ab557fe5b90600052602060002090600d02016003015401600f82815481101515611ad757fe5b90600052602060002090600d020160060154101515611e315743600f82815481101515611b0057fe5b90600052602060002090600d020160040181905550600f81815481101515611b2457fe5b90600052602060002090600d0201600b0160009054906101000a900460ff168015611bb55750611bb4600f82815481101515611b5c57fe5b90600052602060002090600d020160030154600f83815481101515611b7d57fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166114c2565b5b15611d0257600254600f82815481101515611bcc57fe5b90600052602060002090600d020160050181905550600f81815481101515611bf057fe5b90600052602060002090600d02016003015460116000600f84815481101515611c1557fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550600f81815481101515611c9d57fe5b90600052602060002090600d020160030154600e600082825401925050819055507f1b5b1b365eb13a355d4df152d3f305e4b2f9e0a7ffeabd62a340a0b621a51bb28183604051808381526020018281526020019250505060405180910390a1611d69565b600754600f82815481101515611d1457fe5b90600052602060002090600d0201600501819055507f45c094db5d2df9a8875a4dda250d5598d7aa3a5bf4586c9345b1f0231cda39708183604051808381526020018281526020019250505060405180910390a15b600f81815481101515611d7857fe5b90600052602060002090600d020160070154600f82815481101515611d9957fe5b90600052602060002090600d02016002015401431115611e2c576001600f82815481101515611dc457fe5b90600052602060002090600d0201600b0160016101000a81548160ff0219169083151502179055507fa21076cf0a1dbb39af85a6c9123a8a580cf50b5805d381ad37dedc331ee3bf108183604051808381526020018281526020019250505060405180910390a15b611e71565b7ff51c67dd3bb26dd91dfbaeec2c0c4efbc939ce34eab463b948990aeb2d670b4f8183604051808381526020018281526020019250505060405180910390a15b5b5050565b60116020528060005260406000206000915090505481565b600a60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600080600254600f84815481101515611ec957fe5b90600052602060002090600d020160050154148015611fc95750600f83815481101515611ef257fe5b90600052602060002090600d020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161480611fc85750600f83815481101515611f6757fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b5b156121d157601354601254600f85815481101515611fe357fe5b90600052602060002090600d020160020154600f8681548110151561200457fe5b90600052602060002090600d020160040154030281151561202157fe5b04600f8481548110151561203157fe5b90600052602060002090600d02016004015401905080431015156121d057600754600f8481548110151561206157fe5b90600052602060002090600d02016005018190555061207f83612785565b7f117f5a3a0b8d5fd13a1e9534e93382487c9e0f33526c8339d94b898b3c894f108333604051808381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060405180910390a1600f838154811015156120f957fe5b90600052602060002090600d02016003015460116000600f8681548110151561211e57fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540392505081905550600f838154811015156121a657fe5b90600052602060002090600d020160030154600e60008282540392505081905550600191506121d6565b5b600091505b50919050565b60055481565b60008054600f838154811015156121f557fe5b90600052602060002090600d02016005015414801561227f5750600f8281548110151561221e57fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b156124b5576122ae600f8381548110151561229657fe5b90600052602060002090600d020160030154336114c2565b15156122bd57600090506124ba565b600154600f838154811015156122cf57fe5b90600052602060002090600d02016005018190555043600f838154811015156122f457fe5b90600052602060002090600d020160020181905550600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663897b9dcc600f8481548110151561235657fe5b90600052602060002090600d02016003015433600f8681548110151561237857fe5b90600052602060002090600d020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518463ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019350505050600060405180830381600087803b151561246157600080fd5b6102c65a03f1151561247257600080fd5b5050507f2941d6c779233f2de8208db3df35620cd360a367122a3e3c1f40c353d9eba69b826040518082815260200191505060405180910390a1600190506124ba565b600090505b919050565b60025481565b600f818154811015156124d457fe5b90600052602060002090600d02016000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169080600201549080600301549080600401549080600501549080600601549080600701549080600801549080600901549080600a01549080600b0160009054906101000a900460ff169080600b0160019054906101000a900460ff169080600c0190508e565b60106020528060005260406000206000915090505481565b600154600f828154811015156125c357fe5b90600052602060002090600d02016005015414801561264d57503373ffffffffffffffffffffffffffffffffffffffff16600f8281548110151561260357fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b156126b157600554600f8281548110151561266457fe5b90600052602060002090600d0201600501819055507f36407e766a58ca181b915b5f93db227ab6b39f94ba57528a6895430dab339d86816040518082815260200191505060405180910390a15b50565b565b60006126c0612dec565b1561277d57600a60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16637c51fb986000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b151561275357600080fd5b6102c65a03f1151561276457600080fd5b505050604051805190501561277c5760019050612782565b5b600090505b90565b6000806000600f8481548110151561279957fe5b90600052602060002090600d020160020154600f858154811015156127ba57fe5b90600052602060002090600d020160040154039250600d54600f858154811015156127e157fe5b90600052602060002090600d02016003015484028115156127fe57fe5b049150600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663bdc96fad83600f8781548110151561284f57fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b151561290557600080fd5b6102c65a03f1151561291657600080fd5b5050508160106000600f8781548110151561292d57fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254019250508190555081600f858154811015156129b657fe5b90600052602060002090600d020160090160008282540192505081905550600c54600f858154811015156129e657fe5b90600052602060002090600d0201600301548402811515612a0357fe5b049050600f84815481101515612a1557fe5b90600052602060002090600d0201600b0160019054906101000a900460ff161515612c1257600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663bdc96fad82600f87815481101515612a8857fe5b90600052602060002090600d020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b1515612b3e57600080fd5b6102c65a03f11515612b4f57600080fd5b50505080600f85815481101515612b6257fe5b90600052602060002090600d0201600801600082825401925050819055508060106000600f87815481101515612b9457fe5b90600052602060002090600d020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550612de6565b600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663bdc96fad82600f87815481101515612c6057fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b1515612d1657600080fd5b6102c65a03f11515612d2757600080fd5b50505080600f85815481101515612d3a57fe5b90600052602060002090600d0201600901600082825401925050819055508060106000600f87815481101515612d6c57fe5b90600052602060002090600d020160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b50505050565b6000600860009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161480612e975750600960009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b905090565b6101c060405190810160405280600073ffffffffffffffffffffffffffffffffffffffff168152602001600073ffffffffffffffffffffffffffffffffffffffff168152602001600081526020016000815260200160008152602001600081526020016000815260200160008152602001600081526020016000815260200160008152602001600015158152602001600015158152602001612f3c612ff4565b81525090565b815481835581811511612f6f57600d0281600d028360005260206000209182019101612f6e9190613008565b5b505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10612fb557805160ff1916838001178555612fe3565b82800160010185558215612fe3579182015b82811115612fe2578251825591602001919060010190612fc7565b5b509050612ff091906130f5565b5090565b602060405190810160405280600081525090565b6130f291905b808211156130ee57600080820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905560028201600090556003820160009055600482016000905560058201600090556006820160009055600782016000905560088201600090556009820160009055600a820160009055600b820160006101000a81549060ff0219169055600b820160016101000a81549060ff0219169055600c820160006130e5919061311a565b50600d0161300e565b5090565b90565b61311791905b808211156131135760008160009055506001016130fb565b5090565b90565b50805460018160011615610100020316600290046000825580601f10613140575061315f565b601f01602090049060005260206000209081019061315e91906130f5565b5b505600a165627a7a72305820801480515a935105582cc64bab168c3087e0abd4ba42d5231105b37e0410a7e20029', 
                    gas: '4700000'
            }, function (e, managerContract) {
                if (typeof managerContract.address !== 'undefined') {
                    console.log('Token manager contract mined, address: ' + managerContract.address + ' tx: ' + managerContract.transactionHash);
                    console.log('SCENARIO 2: SINGLE LATE PAYMENT WITH MINING');
                    var index = 0;
                    var gasAmount = 290000; // You can optimize the gas for each function call, as will be done in the app.       
                    // Set the new token contract address in the token manager.
                    managerContract.setNewTokenAddress(mainContract.address, {
                        from: web3.eth.accounts[0],
                        gas: gasAmount
                    });

                    // Set the token manager contract in new token contract.
                    mainContract.setTokenManagerContractAddress(managerContract.address, {
                        from: web3.eth.accounts[0],
                        gas: gasAmount
                    });

                    // Increase mineable to allow lenders and borrowers to claim rewards. This provides an upper bound on the possible rewards.
                    // For testing, you can set this an arbitrary number. In the final contracts, the mineable amount will be automatically calculated by the converter.
                    var mineableAmount = new web3.BigNumber('100000000000000000000'); // Set mineable amount in 10^-18 tokens
                    mainContract.increaseMineableAmount(mineableAmount, {
                        from: web3.eth.accounts[0],
                        gas: gasAmount
                    });

                    // Specify the loan parameters
                    var borrower = web3.eth.accounts[1];
                    var lender = web3.eth.accounts[0];
                    var amountToBorrow = new web3.BigNumber('200000000000000000000'); // Amount in 10^-18 tokens
                    var loanLengthInBlocks = new web3.BigNumber('10'); // Use a small number for testing.
                    var interest = new web3.BigNumber('0'); // Interest in 10^-18 tokens
                    var willMine = Boolean(1); // Whether the loan will mine upon completion (see documentation for more info).
                    var loanMessage = 'Will pay you back by next week :)'; // This is an experimental feature. May also use bytes32.
                    var testBalance = new web3.BigNumber('200000000000000000000');
                    mainContract.addTestBalance(testBalance, {
                        from: lender,
                        gas: gasAmount
                    });
                    var initialLenderBalance = new web3.BigNumber(mainContract.balanceOf.call(lender));
                    console.log('Initial balance of lender: ' + mainContract.balanceOf.call(web3.eth.accounts[0]));

                    // Make the request
                    console.log('Requesting a loan...');
                    managerContract.requestLoan(lender, amountToBorrow, loanLengthInBlocks, interest, willMine, loanMessage, {
                        from: borrower,
                        gas: gasAmount
                    });

                    // Now we can check our loan in the loans array:
                    var loan = managerContract.loans.call(index);
                    console.log('Loan has been requested (status=1): ' + loan);

                    // The lender is starting the loan:
                    console.log('Lender is accepting the loan...');
                    managerContract.attemptBeginLoanAtIndex(index, {
                        from: lender,
                        gas: gasAmount
                    });

                    // You'll notice the status of the loan has now changed when you print it out:
                    loan = managerContract.loans.call(index);
                    console.log('Loan is active (status=2): ' + loan);

                    // The borrower's balance has been increased by the loan amount.
                    console.log('Balance of borrower has been increased by the loan amount: ' + mainContract.balanceOf.call(borrower));

                    // Advance some blocks to simulate time passing.
                    for (i = 0; i < 13; i++) { // Pay back late
                        managerContract.advanceBlock();
                    }

                    // The borrower is now going to pay back the loan late:
                    console.log('Borrower is paying back the loan late and in one installment...');
                    var amountToReturn = new web3.BigNumber('200000000000000000000');
                    managerContract.payAmountForLoanAtIndex(amountToReturn, index, {
                        from: borrower,
                        gas: gasAmount
                    });

                    // Borrower has repaid late:
                    console.log('Balance of borrower after repaying loan: ' + mainContract.balanceOf.call(borrower))
                    loan = managerContract.loans.call(index);

                    // Loan status is in holding:
                    console.log('Loan is now in holding (status 3): ' + loan);

                    // Lender needs to wait to claim reward.
                    for (i = 0; i < 16; i++) {
                        managerContract.advanceBlock();
                    }
                    console.log('Lender has waited out the holding period, so lender can claim rewards.');
                    console.log('Since the payment was late, lender is claiming both the borrower and lender reward...');
                    managerContract.requestRewardForLoanAtIndex(index, {
                        from: lender,
                        gas: gasAmount
                    });
                    
                    // Loan status has changed to completed (7)
                    loan = managerContract.loans.call(index);
                    console.log('Loan is complete (status 7): ' + loan);
                    console.log('Only the lender receives a reward, because the borrower payed back late.');
                    console.log('Checking the balances of the lender and borrower shows this:');
                    console.log('Balance of borrower: ' + mainContract.balanceOf.call(borrower));
                    console.log('Balance of lender: ' + mainContract.balanceOf.call(lender));
                    console.log('Scenario 2 complete.');
                }
            })
        }
        })
      </script>
   </body>
</html>